{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport React, { Component } from \"react\";\nimport ReceptionsitFactory from \"../../build/contracts/ReceptionsitFactory.json\";\nimport Receptionist from \"../../build/contracts/Receptionsit.json\";\nimport { Form, Button, Input, Message } from \"semantic-ui-react\";\nimport { Link } from \"../../routes\";\nimport getWeb3 from \"../../ethereum/getWeb3\";\nimport web3 from \"../../ethereum/web3\";\nimport truffleContract from \"truffle-contract\";\nimport Layout from \"../../components/Layout\";\n\nvar register =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(register, _Component);\n\n  function register() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, register);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(register)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"state\", _defineProperty({\n      web3: null,\n      accounts: null,\n      hospitalName: \"\",\n      receptionistName: \"\",\n      instanceFactory1: \"\",\n      receptionistInstance: \"\",\n      recetionistAddress: \"\",\n      accountForFirstTime: \"\",\n      errorMessage: \"\",\n      loading: false\n    }, \"accounts\", \"\"));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"onSubmit\",\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(event) {\n        var accounts, Contract, instanceFactory, instanceFactory1, manager, rec;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                event.preventDefault();\n                _context.prev = 1;\n\n                // const web3 = await getWeb3();\n                // const accounts = await web3.eth.getAccounts();\n                // this.setState({ web3 });\n                _this.setState({\n                  loading: true,\n                  errorMessage: \"\"\n                });\n\n                console.log(\"Onsubmit\"); // const { web3 } = this.state;\n                // console.log(\"WEB3\", web3);\n\n                _context.next = 6;\n                return web3.eth.getAccounts();\n\n              case 6:\n                accounts = _context.sent;\n                console.log(\"We3:\", web3);\n                Contract = truffleContract(ReceptionsitFactory);\n                Contract.setProvider(web3.currentProvider);\n                _context.next = 12;\n                return Contract.deployed();\n\n              case 12:\n                instanceFactory = _context.sent;\n                instanceFactory1 = instanceFactory.address;\n                console.log(\"factory:\", instanceFactory);\n\n                _this.setState({\n                  instanceFactory: instanceFactory\n                });\n\n                console.log(\"address:\", instanceFactory1);\n\n                _this.setState({\n                  instanceFactory1: instanceFactory1\n                });\n\n                _context.prev = 18;\n                _context.next = 21;\n                return instanceFactory.manager.call();\n\n              case 21:\n                manager = _context.sent;\n                _context.next = 27;\n                break;\n\n              case 24:\n                _context.prev = 24;\n                _context.t0 = _context[\"catch\"](18);\n                console.log(_context.t0);\n\n              case 27:\n                console.log(\"MAnager:\"); //  var manager = await instanceFactory.manager.call();\n                //  const receptionistInstance = await ContractReceptionist.at(address);\n\n                alert(accounts[0] + \" will be your account for admin\");\n                _context.prev = 29;\n                _context.next = 32;\n                return instanceFactory.createReceptionist(_this.state.hospitalName, _this.state.receptionistName, {\n                  from: accounts[0]\n                });\n\n              case 32:\n                rec = _context.sent;\n                alert(\"Registered Successfully\");\n                _context.next = 40;\n                break;\n\n              case 36:\n                _context.prev = 36;\n                _context.t1 = _context[\"catch\"](29);\n                console.log(\"Error of try:\", _context.t1);\n\n                _this.setState({\n                  errorMessage: _context.t1.message\n                });\n\n              case 40:\n                _context.next = 46;\n                break;\n\n              case 42:\n                _context.prev = 42;\n                _context.t2 = _context[\"catch\"](1);\n                console.log(_context.t2);\n\n                _this.setState({\n                  errorMessage: err.message\n                });\n\n              case 46:\n                _this.setState({\n                  loading: false\n                });\n\n              case 47:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[1, 42], [18, 24], [29, 36]]);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"onHospitalHandle\", function (event) {\n      _this.setState({\n        hospitalName: event.target.value,\n        loading: false,\n        errorMessage: \"\"\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"onReceptionistHandle\", function (event) {\n      _this.setState({\n        receptionistName: event.target.value\n      });\n    });\n\n    return _this;\n  }\n\n  _createClass(register, [{\n    key: \"render\",\n    value: function render() {\n      return React.createElement(Layout, null, React.createElement(\"div\", null, React.createElement(\"h1\", null, \"Register new Receptionist\"), React.createElement(\"h3\", null, \"Create new Receptionist\"), React.createElement(Form, {\n        onSubmit: this.onSubmit,\n        error: !!this.state.errorMessage\n      }, React.createElement(Form.Field, null, React.createElement(\"label\", null, \"Hospital Name\"), React.createElement(Input, {\n        value: this.state.hospitalName,\n        onChange: this.onHospitalHandle\n      })), React.createElement(Form.Field, null, React.createElement(\"label\", null, \"Admin Name\"), React.createElement(Input, {\n        value: this.state.receptionistName,\n        onChange: this.onReceptionistHandle\n      })), React.createElement(Message, {\n        error: true,\n        header: \"Oops..!\",\n        content: this.state.errorMessage\n      }), React.createElement(Button, {\n        loading: this.state.loading,\n        primary: true\n      }, \" \", \"Register Admin/Receptionsit\", \" \"))));\n    }\n  }]);\n\n  return register;\n}(Component);\n\nexport default register;","map":null,"metadata":{},"sourceType":"module"}