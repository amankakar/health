{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _parseInt from \"@babel/runtime-corejs2/core-js/parse-int\";\nimport _Promise from \"@babel/runtime-corejs2/core-js/promise\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport React, { Component } from \"react\";\nimport Layout from \"../../components/doctorLayout\";\nimport ReceptionistFactory from \"../../build/contracts/ReceptionsitFactory.json\";\nimport Patient from \"../../build/contracts/Patient.json\";\nimport PatientRecord from \"../../components/patientRecord\";\nimport truffleContract from \"truffle-contract\";\nimport web3 from \"../../ethereum/web3\";\nimport { Table } from \"semantic-ui-react\";\n\nvar patientRecord =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(patientRecord, _Component);\n\n  function patientRecord() {\n    _classCallCheck(this, patientRecord);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(patientRecord).apply(this, arguments));\n  }\n\n  _createClass(patientRecord, [{\n    key: \"renderRow\",\n    value: function renderRow() {\n      return this.props.appointmentListData.map(function (appointment, index) {\n        return React.createElement(PatientRecord, {\n          key: index,\n          appointment: appointment\n        });\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var Header = Table.Header,\n          Row = Table.Row,\n          HeaderCell = Table.HeaderCell,\n          Body = Table.Body;\n      return React.createElement(Layout, null, React.createElement(\"div\", null, React.createElement(\"h1\", null, \"Patient Record\"), React.createElement(Table, null, React.createElement(Header, null, React.createElement(Row, null, React.createElement(HeaderCell, null, \"Date\"), React.createElement(HeaderCell, null, \"Chief Complaint\"), React.createElement(HeaderCell, null, \" Hash\"))), React.createElement(Body, null, this.renderRow()))));\n    }\n  }], [{\n    key: \"getInitialProps\",\n    value: function () {\n      var _getInitialProps = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(props) {\n        var patientId, factory, instanceFactory, patient, patientAddress, patientContract, appointmentList, appointmentListData;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                patientId = props.query.patientId;\n                factory = truffleContract(ReceptionistFactory);\n                factory.setProvider(web3.currentProvider);\n                _context2.next = 5;\n                return factory.deployed();\n\n              case 5:\n                instanceFactory = _context2.sent;\n                patient = truffleContract(Patient);\n                patient.setProvider(web3.currentProvider);\n                _context2.next = 10;\n                return instanceFactory.patientIdToAddress.call(props.query.patientId);\n\n              case 10:\n                patientAddress = _context2.sent;\n                _context2.next = 13;\n                return patient.at(patientAddress);\n\n              case 13:\n                patientContract = _context2.sent;\n                console.log(patientAddress);\n                _context2.next = 17;\n                return patientContract.getAppointmentList.call();\n\n              case 17:\n                appointmentList = _context2.sent;\n                console.log(appointmentList);\n                _context2.next = 21;\n                return _Promise.all(Array(_parseInt(appointmentList)).fill().map(\n                /*#__PURE__*/\n                function () {\n                  var _ref = _asyncToGenerator(\n                  /*#__PURE__*/\n                  _regeneratorRuntime.mark(function _callee(element, index) {\n                    var appointmentId;\n                    return _regeneratorRuntime.wrap(function _callee$(_context) {\n                      while (1) {\n                        switch (_context.prev = _context.next) {\n                          case 0:\n                            _context.next = 2;\n                            return patientContract.appointmentsList.call(index);\n\n                          case 2:\n                            appointmentId = _context.sent;\n                            return _context.abrupt(\"return\", patientContract.appointments.call(appointmentId));\n\n                          case 4:\n                          case \"end\":\n                            return _context.stop();\n                        }\n                      }\n                    }, _callee, this);\n                  }));\n\n                  return function (_x2, _x3) {\n                    return _ref.apply(this, arguments);\n                  };\n                }()));\n\n              case 21:\n                appointmentListData = _context2.sent;\n                console.log(\"Appointment Data:\", appointmentListData);\n                return _context2.abrupt(\"return\", {\n                  patientId: patientId,\n                  appointmentListData: appointmentListData\n                });\n\n              case 24:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function getInitialProps(_x) {\n        return _getInitialProps.apply(this, arguments);\n      }\n\n      return getInitialProps;\n    }()\n  }]);\n\n  return patientRecord;\n}(Component);\n\nexport default patientRecord;","map":null,"metadata":{},"sourceType":"module"}